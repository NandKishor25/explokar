(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{2751:function(e,t,r){Promise.resolve().then(r.bind(r,1153))},2030:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Compass",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76",key:"m9r19z"}]])},2022:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},1153:function(e,t,r){"use strict";r.d(t,{default:function(){return f}});var a=r(7437),s=r(2265),l=r(7138),o=r(6463),i=r(7048),n=r(2030),d=r(1066);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,d.Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);var u=r(2022),h=r(4697);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,d.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);var m=r(4137),f=()=>{let{currentUser:e,logout:t,loading:r}=(0,i.a)(),{notifications:d,unreadCount:f,markAsRead:p,markAllAsRead:g}=(0,m.z)(),b=(0,o.useRouter)(),[y,v]=(0,s.useState)(!1),j=async()=>{try{await t(),b.push("/login")}catch(e){console.error("Failed to log out",e)}},w=async(t,r,a)=>{try{if(!e)return;await fetch("/api/requests/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json","x-user-id":e.uid},body:JSON.stringify({status:r})}),await p(a)}catch(e){console.error("Error handling request:",e)}};return r?(0,a.jsx)("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white/95 border-b border-stone-100",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"flex justify-between h-20",children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-2xl font-serif font-bold text-stone-900",children:"Explokar"})})})})}):(0,a.jsxs)("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white border-b border-slate-100 shadow-sm transition-all duration-300",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-20 items-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)(l.default,{href:"/",className:"flex-shrink-0 flex items-center gap-2",children:[(0,a.jsx)(n.Z,{className:"h-8 w-8 text-blue-500",strokeWidth:2.5}),(0,a.jsx)("span",{className:"text-2xl font-bold text-slate-800 tracking-tight",children:"Explokar"})]})}),(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,a.jsx)(l.default,{href:"/",className:"text-sm font-medium text-slate-600 hover:text-blue-600 transition-colors",children:"Home"}),(0,a.jsx)(l.default,{href:"/my-trips",className:"text-sm font-medium text-slate-600 hover:text-blue-600 transition-colors",children:"My Trips"}),(0,a.jsx)(l.default,{href:"/create-trip",className:"text-sm font-medium text-slate-600 hover:text-blue-600 transition-colors",children:"Create Trip"}),e&&(0,a.jsxs)("div",{className:"relative group mr-4",children:[(0,a.jsxs)("button",{className:"relative p-2 text-slate-600 hover:text-blue-600 transition-colors",children:[(0,a.jsx)(c,{className:"h-6 w-6"}),f>0&&(0,a.jsx)("div",{className:"absolute top-1 right-1 w-4 h-4 bg-red-500 rounded-full border border-white text-[10px] flex items-center justify-center text-white font-bold",children:f>9?"9+":f})]}),(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-xl shadow-xl border border-slate-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all transform translate-y-2 group-hover:translate-y-0 z-50",children:[(0,a.jsxs)("div",{className:"p-3 border-b border-slate-100 flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:"Notifications"}),f>0&&(0,a.jsx)("button",{onClick:()=>g(),className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"Mark all read"})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:d.length>0?d.map(e=>(0,a.jsx)("div",{className:"p-3 border-b border-slate-50 hover:bg-slate-50 transition-colors ".concat(e.read?"":"bg-blue-50/50"),children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-200 overflow-hidden flex-shrink-0",children:e.sender.photoURL?(0,a.jsx)("img",{src:e.sender.photoURL,alt:e.sender.name,className:"w-full h-full object-cover"}):(0,a.jsx)(u.Z,{className:"w-full h-full p-1.5 text-slate-400"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-slate-800 leading-snug",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.createdAt).toLocaleDateString()}),"JOIN_REQUEST"===e.type&&e.relatedId&&(0,a.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.relatedId,"accepted",e._id)},className:"px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700",children:"Accept"}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.relatedId,"rejected",e._id)},className:"px-3 py-1 bg-slate-200 text-slate-700 text-xs rounded-md hover:bg-slate-300",children:"Decline"})]})]})]})},e._id)):(0,a.jsx)("div",{className:"p-8 text-center text-slate-500 text-sm",children:"No notifications"})})]})]}),e?(0,a.jsxs)("div",{className:"relative group cursor-pointer",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-slate-200 border-2 border-white shadow-sm overflow-hidden",children:e.photoURL?(0,a.jsx)("img",{src:e.photoURL,alt:"User",className:"w-full h-full object-cover"}):(0,a.jsx)(u.Z,{className:"w-full h-full p-2 text-slate-400"})}),(0,a.jsx)("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all transform translate-y-2 group-hover:translate-y-0",children:(0,a.jsxs)("div",{className:"p-2 space-y-1",children:[(0,a.jsx)(l.default,{href:"/profile",className:"block px-3 py-2 text-sm text-slate-600 hover:bg-slate-50 rounded-lg",children:"Profile"}),(0,a.jsx)("button",{onClick:j,className:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg",children:"Logout"})]})})]}):(0,a.jsx)(l.default,{href:"/login",className:"px-5 py-2.5 rounded-full text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 transition-colors shadow-lg shadow-blue-500/20",children:"Login"})]}),(0,a.jsx)("div",{className:"md:hidden flex items-center",children:(0,a.jsx)("button",{onClick:()=>{v(!y)},className:"inline-flex items-center justify-center p-2 rounded-md text-slate-700 hover:text-blue-600 hover:bg-slate-50 transition-colors",children:y?(0,a.jsx)(h.Z,{className:"h-6 w-6"}):(0,a.jsx)(x,{className:"h-6 w-6"})})})]})}),y&&(0,a.jsx)("div",{className:"md:hidden bg-stone-900 border-b border-white/10",children:(0,a.jsxs)("div",{className:"px-4 pt-2 pb-6 space-y-2",children:[(0,a.jsx)(l.default,{href:"/",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10 hover:text-white",onClick:()=>v(!1),children:"Home"}),(0,a.jsx)(l.default,{href:"/search",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10 hover:text-white",onClick:()=>v(!1),children:"Destinations"}),e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.default,{href:"/create-trip",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10 hover:text-white",onClick:()=>v(!1),children:"Plan a Trip"}),(0,a.jsx)(l.default,{href:"/my-trips",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10 hover:text-white",onClick:()=>v(!1),children:"My Trips"}),(0,a.jsx)(l.default,{href:"/profile",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10 hover:text-white",onClick:()=>v(!1),children:"Profile"}),(0,a.jsx)("button",{onClick:()=>{j(),v(!1)},className:"block w-full text-left px-4 py-3 rounded-lg text-base font-medium text-red-500 hover:bg-white/5",children:"Logout"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"pt-4 border-t border-white/10 mt-2"}),(0,a.jsx)(l.default,{href:"/login",className:"block px-4 py-3 rounded-lg text-base font-medium text-gray-300 hover:bg-white/10",onClick:()=>v(!1),children:"Log in"}),(0,a.jsx)(l.default,{href:"/register",className:"block px-4 py-3 rounded-lg text-base font-medium text-white bg-blue-600 hover:bg-blue-500",onClick:()=>v(!1),children:"Sign up"})]})]})})]})}},4137:function(e,t,r){"use strict";r.d(t,{J:function(){return n},z:function(){return d}});var a=r(7437),s=r(2265),l=r(7048);let o={getNotifications:async e=>(await fetch("/api/notifications",{headers:{"x-user-id":e}})).json(),markRead:async(e,t,r)=>fetch("/api/notifications",{method:"PUT",headers:{"x-user-id":e,"Content-Type":"application/json"},body:JSON.stringify({notificationId:t,markAll:r})})},i=(0,s.createContext)(void 0);function n(e){let{children:t}=e,{currentUser:r}=(0,l.a)(),[n,d]=(0,s.useState)([]),[c,u]=(0,s.useState)(0),[h,x]=(0,s.useState)(!1),m=async()=>{if(null==r?void 0:r.uid)try{let e=await o.getNotifications(r.uid);d(e.notifications),u(e.unreadCount)}catch(e){console.error("Failed to fetch notifications",e)}},f=async e=>{if(null==r?void 0:r.uid)try{e&&(d(t=>t.map(t=>t._id===e?{...t,read:!0}:t)),u(e=>Math.max(0,e-1)),await o.markRead(r.uid,e))}catch(e){console.error("Failed to mark as read",e),m()}},p=async()=>{if(null==r?void 0:r.uid)try{d(e=>e.map(e=>({...e,read:!0}))),u(0),await o.markRead(r.uid,void 0,!0)}catch(e){console.error("Failed to mark all as read",e),m()}};return(0,s.useEffect)(()=>{if(null==r?void 0:r.uid){m();let e=setInterval(m,3e4);return()=>clearInterval(e)}d([]),u(0)},[null==r?void 0:r.uid]),(0,a.jsx)(i.Provider,{value:{notifications:n,unreadCount:c,loading:h,refreshNotifications:m,markAsRead:f,markAllAsRead:p},children:t})}function d(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},7048:function(e,t,r){"use strict";r.d(t,{a:function(){return l}});var a=r(1444),s=r(7594);function l(){let e=(0,a.I0)(),{currentUser:t,loading:r,error:l}=(0,a.v9)(e=>e.auth);return{currentUser:t,loading:r,error:l,register:(t,r,a)=>e((0,s.z2)({email:t,password:r,name:a})),login:(t,r)=>e((0,s.x4)({email:t,password:r})),loginWithGoogle:()=>e((0,s.Cb)()),logout:()=>e((0,s.kS)()),updateUserProfile:t=>e((0,s.Lj)(t))}}},7594:function(e,t,r){"use strict";r.d(t,{ZP:function(){return w},uJ:function(){return h},x4:function(){return m},Cb:function(){return f},kS:function(){return p},z2:function(){return x},Lj:function(){return g}});var a=r(6862),s=r(5735),l=r(5236),o=r(9854);let i=(0,l.ZF)({apiKey:"AIzaSyCGhp1cC_bCwRHFzSrI3yTDJ9LOOlZy1i4",authDomain:"explokar-a27aa.firebaseapp.com",projectId:"explokar-a27aa",storageBucket:"explokar-a27aa.firebasestorage.app",messagingSenderId:"672347253575",appId:"1:672347253575:web:24ab4e1304c83a01277a62"}),n=(0,s.v0)(i);(0,o.cF)(i);var d=r(8472),c=r(8726);let u=e=>({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL}),h=(0,a.hg)("auth/initialize",async(e,t)=>{let{dispatch:r}=t;return new Promise(e=>{let t=(0,s.Aj)(n,a=>{r(y(a?u(a):null)),t(),e()})})}),x=(0,a.hg)("auth/register",async(e,t)=>{let{email:r,password:a,name:l}=e,{rejectWithValue:o}=t;try{let e=await (0,s.Xb)(n,r,a);return await (0,s.ck)(e.user,{displayName:l}),await d.Z.post("/api/auth",{uid:e.user.uid,email:e.user.email,name:l,photoURL:e.user.photoURL||""}),u(e.user)}catch(e){return console.error("Error during registration:",e),c.ZP.error(e.message),o(e.message)}}),m=(0,a.hg)("auth/login",async(e,t)=>{let{email:r,password:a}=e,{rejectWithValue:l}=t;try{let e=await (0,s.e5)(n,r,a);return u(e.user)}catch(e){return console.error("Error during login:",e),c.ZP.error(e.message),l(e.message)}}),f=(0,a.hg)("auth/loginWithGoogle",async(e,t)=>{let{rejectWithValue:r}=t;try{let e=new s.hJ,t=await (0,s.rh)(n,e);try{await d.Z.post("/api/auth",{uid:t.user.uid,email:t.user.email,name:t.user.displayName,photoURL:t.user.photoURL||""})}catch(e){console.log("User might already exist in the database.")}return u(t.user)}catch(e){return"auth/popup-blocked"===e.code?await (0,s.F6)(n,new s.hJ):(console.error("Error during Google login:",e),c.ZP.error(e.message)),r(e.message)}}),p=(0,a.hg)("auth/logout",async(e,t)=>{let{rejectWithValue:r}=t;try{await (0,s.w7)(n),c.ZP.success("Successfully logged out")}catch(e){return console.error("Error during logout:",e),c.ZP.error("Failed to log out"),r(e.message)}}),g=(0,a.hg)("auth/updateProfile",async(e,t)=>{let{getState:r,rejectWithValue:a}=t;r();let l=n.currentUser;if(!l)return a("No user logged in");try{return await (0,s.ck)(l,e),await d.Z.put("/api/auth/".concat(l.uid),{name:e.displayName,photoURL:e.photoURL}),c.ZP.success("Profile updated successfully"),e}catch(e){return console.error("Error updating profile:",e),c.ZP.error("Failed to update profile"),a(e.message)}}),b=(0,a.oM)({name:"auth",initialState:{currentUser:null,loading:!0,error:null},reducers:{setUser:(e,t)=>{e.currentUser=t.payload,e.loading=!1},setLoading:(e,t)=>{e.loading=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(x.pending,e=>{e.loading=!0,e.error=null}).addCase(x.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(x.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(m.pending,e=>{e.loading=!0,e.error=null}).addCase(m.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(m.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(f.pending,e=>{e.loading=!0,e.error=null}).addCase(f.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(f.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(p.fulfilled,e=>{e.currentUser=null}).addCase(g.fulfilled,(e,t)=>{e.currentUser&&(e.currentUser={...e.currentUser,...t.payload})})}}),{setUser:y,setLoading:v,clearError:j}=b.actions;var w=b.reducer}},function(e){e.O(0,[139,18,344,233,971,23,744],function(){return e(e.s=2751)}),_N_E=e.O()}]);