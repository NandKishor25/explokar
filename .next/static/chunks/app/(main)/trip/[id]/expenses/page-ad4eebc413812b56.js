(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[15],{8:function(e,t,r){Promise.resolve().then(r.bind(r,310))},5137:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1077:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},2513:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},883:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1240:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(1066).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},6463:function(e,t,r){"use strict";var a=r(1169);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},310:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7437),s=r(2265),n=r(6463),i=r(7138),o=r(7048),d=r(6223),l=r(5137),c=r(2513),u=r(1077),p=r(1240);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,r(1066).Z)("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);var g=r(883),h=r(8726),m=()=>{let e=(0,n.useParams)(),t=null==e?void 0:e.id,{currentUser:r}=(0,o.a)(),[m,y]=(0,s.useState)(null),[f,w]=(0,s.useState)([]),[j,b]=(0,s.useState)(!0),[N,v]=(0,s.useState)(!1),[Z,k]=(0,s.useState)({description:"",amount:"",category:"Food",date:new Date().toISOString().split("T")[0]});(0,s.useEffect)(()=>{(async()=>{if(t)try{b(!0);let[e,r]=await Promise.all([d.e.getTripById(t),d.e.getExpenses(t)]);y(e),w(r)}catch(e){console.error("Error fetching data:",e),h.ZP.error("Failed to load expenses")}finally{b(!1)}})()},[t]);let P=async e=>{if(e.preventDefault(),t&&r)try{let e=await d.e.addExpense(t,{...Z,amount:parseFloat(Z.amount),paidBy:r.uid,splitAmong:(null==m?void 0:m.participants.map(e=>e.userId))||[],tripId:t});w([...f,e]),v(!1),k({description:"",amount:"",category:"Food",date:new Date().toISOString().split("T")[0]}),h.ZP.success("Expense added")}catch(e){console.error("Error adding expense:",e),h.ZP.error("Failed to add expense")}},C=async e=>{if(t&&window.confirm("Delete this expense?"))try{await d.e.deleteExpense(t,e),w(f.filter(t=>t._id!==e)),h.ZP.success("Expense deleted")}catch(e){console.error("Error deleting expense:",e),h.ZP.error("Failed to delete expense")}},E=f.reduce((e,t)=>e+t.amount,0),S=(null==m?void 0:m.participants)?E/m.participants.length:0;return j?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):m?(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)(i.default,{href:"/trip/".concat(t),className:"flex items-center text-indigo-600 hover:text-indigo-800 mb-4",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 mr-1"})," Back to Trip"]}),(0,a.jsxs)("div",{className:"flex justify-between items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Expenses"}),(0,a.jsxs)("p",{className:"text-gray-500",children:["Manage costs for ",m.title]})]}),(0,a.jsxs)("button",{onClick:()=>v(!N),className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow-md",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 mr-2"})," Add Expense"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-green-100 rounded-full text-green-600 mr-4",children:(0,a.jsx)(u.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Total Spent"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",E.toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-blue-100 rounded-full text-blue-600 mr-4",children:(0,a.jsx)(p.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Participants"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:m.participants.length})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex items-center",children:[(0,a.jsx)("div",{className:"p-3 bg-purple-100 rounded-full text-purple-600 mr-4",children:(0,a.jsx)(x,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Per Person"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["$",S.toFixed(2)]})]})]})]}),N&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-md border border-gray-100 mb-8 animate-in slide-in-from-top-4 duration-300",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Add New Expense"}),(0,a.jsxs)("form",{onSubmit:P,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Description (e.g., Dinner)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:Z.description,onChange:e=>k({...Z,description:e.target.value}),required:!0}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),(0,a.jsx)("input",{type:"number",placeholder:"Amount",className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:Z.amount,onChange:e=>k({...Z,amount:e.target.value}),required:!0,min:"0",step:"0.01"})]}),(0,a.jsxs)("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:Z.category,onChange:e=>k({...Z,category:e.target.value}),children:[(0,a.jsx)("option",{children:"Food"}),(0,a.jsx)("option",{children:"Transport"}),(0,a.jsx)("option",{children:"Accommodation"}),(0,a.jsx)("option",{children:"Activity"}),(0,a.jsx)("option",{children:"Other"})]}),(0,a.jsx)("input",{type:"date",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none",value:Z.date,onChange:e=>k({...Z,date:e.target.value}),required:!0}),(0,a.jsx)("button",{type:"submit",className:"md:col-span-2 bg-indigo-600 text-white py-2 rounded-lg font-semibold hover:bg-indigo-700 transition-colors",children:"Save Expense"})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid By"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200",children:0===f.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,className:"px-6 py-10 text-center text-gray-500",children:"No expenses recorded yet."})}):f.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:e.description}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded-full text-xs",children:e.category})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(null===(t=m.participants.find(t=>t.userId===e.paidBy))||void 0===t?void 0:t.name)||"Unknown"}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right font-medium",children:["$",e.amount.toFixed(2)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>C(e._id),className:"text-red-400 hover:text-red-600 transition-colors",children:(0,a.jsx)(g.Z,{className:"w-4 h-4"})})})]},e._id)})})]})})})]}):(0,a.jsx)("div",{className:"text-center py-20",children:"Trip not found"})}},7048:function(e,t,r){"use strict";r.d(t,{a:function(){return n}});var a=r(1444),s=r(7594);function n(){let e=(0,a.I0)(),{currentUser:t,loading:r,error:n}=(0,a.v9)(e=>e.auth);return{currentUser:t,loading:r,error:n,register:(t,r,a)=>e((0,s.z2)({email:t,password:r,name:a})),login:(t,r)=>e((0,s.x4)({email:t,password:r})),loginWithGoogle:()=>e((0,s.Cb)()),logout:()=>e((0,s.kS)()),updateUserProfile:t=>e((0,s.Lj)(t))}}},4438:function(e,t,r){"use strict";let a=r(8472).Z.create({headers:{"Content-Type":"application/json"}});t.Z=a},6223:function(e,t,r){"use strict";r.d(t,{e:function(){return s}});var a=r(4438);let s={searchTrips:async e=>(await a.Z.get("/api/trips/search?".concat(e.toString()))).data,getTripById:async e=>(await a.Z.get("/api/trips/".concat(e))).data,getUserTrips:async e=>(await a.Z.get("/api/trips/user/".concat(e))).data,createTrip:async e=>(await a.Z.post("/api/trips",e)).data,deleteTrip:async e=>(await a.Z.delete("/api/trips/".concat(e))).data,joinTrip:async(e,t)=>(await a.Z.post("/api/trips/".concat(e,"/join"),t)).data,leaveTrip:async(e,t)=>(await a.Z.post("/api/trips/".concat(e,"/leave"),t)).data,getComments:async e=>(await a.Z.get("/api/trips/".concat(e,"/comments"))).data,addComment:async(e,t)=>(await a.Z.post("/api/trips/".concat(e,"/comments"),t)).data,getExpenses:async e=>{try{return(await a.Z.get("/api/trips/".concat(e,"/expenses"))).data}catch(e){return console.warn("Expense API not ready, returning mock data"),[]}},addExpense:async(e,t)=>(await a.Z.post("/api/trips/".concat(e,"/expenses"),t)).data,deleteExpense:async(e,t)=>(await a.Z.delete("/api/trips/".concat(e,"/expenses/").concat(t))).data}},7594:function(e,t,r){"use strict";r.d(t,{ZP:function(){return N},uJ:function(){return p},x4:function(){return g},Cb:function(){return h},kS:function(){return m},z2:function(){return x},Lj:function(){return y}});var a=r(6862),s=r(5735),n=r(5236),i=r(9854);let o=(0,n.ZF)({apiKey:"AIzaSyCGhp1cC_bCwRHFzSrI3yTDJ9LOOlZy1i4",authDomain:"explokar-a27aa.firebaseapp.com",projectId:"explokar-a27aa",storageBucket:"explokar-a27aa.firebasestorage.app",messagingSenderId:"672347253575",appId:"1:672347253575:web:24ab4e1304c83a01277a62"}),d=(0,s.v0)(o);(0,i.cF)(o);var l=r(8472),c=r(8726);let u=e=>({uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL}),p=(0,a.hg)("auth/initialize",async(e,t)=>{let{dispatch:r}=t;return new Promise(e=>{let t=(0,s.Aj)(d,a=>{r(w(a?u(a):null)),t(),e()})})}),x=(0,a.hg)("auth/register",async(e,t)=>{let{email:r,password:a,name:n}=e,{rejectWithValue:i}=t;try{let e=await (0,s.Xb)(d,r,a);return await (0,s.ck)(e.user,{displayName:n}),await l.Z.post("/api/auth",{uid:e.user.uid,email:e.user.email,name:n,photoURL:e.user.photoURL||""}),u(e.user)}catch(e){return console.error("Error during registration:",e),c.ZP.error(e.message),i(e.message)}}),g=(0,a.hg)("auth/login",async(e,t)=>{let{email:r,password:a}=e,{rejectWithValue:n}=t;try{let e=await (0,s.e5)(d,r,a);return u(e.user)}catch(e){return console.error("Error during login:",e),c.ZP.error(e.message),n(e.message)}}),h=(0,a.hg)("auth/loginWithGoogle",async(e,t)=>{let{rejectWithValue:r}=t;try{let e=new s.hJ,t=await (0,s.rh)(d,e);try{await l.Z.post("/api/auth",{uid:t.user.uid,email:t.user.email,name:t.user.displayName,photoURL:t.user.photoURL||""})}catch(e){console.log("User might already exist in the database.")}return u(t.user)}catch(e){return"auth/popup-blocked"===e.code?await (0,s.F6)(d,new s.hJ):(console.error("Error during Google login:",e),c.ZP.error(e.message)),r(e.message)}}),m=(0,a.hg)("auth/logout",async(e,t)=>{let{rejectWithValue:r}=t;try{await (0,s.w7)(d),c.ZP.success("Successfully logged out")}catch(e){return console.error("Error during logout:",e),c.ZP.error("Failed to log out"),r(e.message)}}),y=(0,a.hg)("auth/updateProfile",async(e,t)=>{let{getState:r,rejectWithValue:a}=t;r();let n=d.currentUser;if(!n)return a("No user logged in");try{return await (0,s.ck)(n,e),await l.Z.put("/api/auth/".concat(n.uid),{name:e.displayName,photoURL:e.photoURL}),c.ZP.success("Profile updated successfully"),e}catch(e){return console.error("Error updating profile:",e),c.ZP.error("Failed to update profile"),a(e.message)}}),f=(0,a.oM)({name:"auth",initialState:{currentUser:null,loading:!0,error:null},reducers:{setUser:(e,t)=>{e.currentUser=t.payload,e.loading=!1},setLoading:(e,t)=>{e.loading=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(x.pending,e=>{e.loading=!0,e.error=null}).addCase(x.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(x.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(g.pending,e=>{e.loading=!0,e.error=null}).addCase(g.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(g.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,(e,t)=>{e.currentUser=t.payload,e.loading=!1}).addCase(h.rejected,(e,t)=>{e.error=t.payload,e.loading=!1}).addCase(m.fulfilled,e=>{e.currentUser=null}).addCase(y.fulfilled,(e,t)=>{e.currentUser&&(e.currentUser={...e.currentUser,...t.payload})})}}),{setUser:w,setLoading:j,clearError:b}=f.actions;var N=f.reducer}},function(e){e.O(0,[139,18,344,233,971,23,744],function(){return e(e.s=8)}),_N_E=e.O()}]);